---
title: "Languages and Music Perception"
output: 
  flexdashboard::flex_dashboard:
  storyboard: true
---

```{r setup, include=FALSE}
library(flexdashboard)
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyverse)
library(readxl)
DSEML_results <- read_excel("DSEML results.xlsx")
```

Column {.tabset}
-----------------------------------------------------------------------

### Chart A

```{r}
valence <-
  DSEML_results %>%
    select(c(valence_E_low_1, valence_D_low_1, valence_M_low_1, valence_H_low_1, valence_E_mid_1, valence_D_mid_1, valence_M_mid_1, valence_H_mid_1, valence_E_high_1, valence_D_high_1, valence_M_high_1, valence_H_high_1)) %>%
      pivot_longer(c("valence_E_low_1", "valence_D_low_1",
                     "valence_M_low_1", "valence_H_low_1",
                     "valence_E_mid_1", "valence_D_mid_1",
                     "valence_M_mid_1", "valence_H_mid_1",
                     "valence_E_high_1", "valence_D_high_1",
                     "valence_M_high_1", "valence_H_high_1"),
                   names_to = "Languages",
                   values_to = "values_mean") %>%
        group_by(Languages) %>% 
          summarise(Values = mean(values_mean))

valence['Valence_degree'] <- c("high", "low", "mid", "high", "low", "mid",
                      "high", "low", "mid", "high", "low", "mid")

valence[1, 1] = "Dutch"
valence[2, 1] = "Dutch"
valence[3, 1] = "Dutch"
valence[4, 1] = "English"
valence[5, 1] = "English"
valence[6, 1] = "English"
valence[7, 1] = "Hindi"
valence[8, 1] = "Hindi"
valence[9, 1] = "Hindi"
valence[10, 1] = "Mandarin"
valence[11, 1] = "Mandarin"
valence[12, 1] = "Mandarin"

ggplot(valence, aes(fill=Languages, y=Values, x=Valence_degree)) + 
geom_bar(position="dodge", stat="identity") + ggtitle("Valence") +
scale_fill_manual(values=c("#4019FF", "#D400FF", "#FF1919", "#FF9933"))
```

### Chart AA

```{r}
Dutch = length(which(DSEML_results$dutch == 5)) + length(which(DSEML_results$dutch == 6))
English = length(which(DSEML_results$english == 5)) + length(which(DSEML_results$english == 6))
Hindi = length(which(DSEML_results$hindi == 5)) + length(which(DSEML_results$hindi == 6))
Mandarin = length(which(DSEML_results$mandarin == 5)) + length(which(DSEML_results$mandarin == 6))
filtering <- filter(DSEML_results, dutch != 5, dutch != 6, english != 5, english != 6, hindi != 5, hindi != 6, mandarin !=5, mandarin != 6)
Other = length(filtering$dutch)

pie_chart <- data.frame("languages" = c('Dutch', 'English', 'Mandarin', 'Hindi', 'Other'), "amount" = c(Dutch, English, Mandarin, Hindi, Other))

ggplot(pie_chart, aes(x="", y=amount, fill=languages)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) + geom_text(aes(label = paste0(amount)), position = position_stack(vjust=0.5)) +
  labs(x = NULL, y = NULL, fill = NULL)

```

Column
-----------------------------------------------------------------------


### Explanation of pie chart

#### this is a header
There should come some text hear explaining the pie chart on the left, which explains that the chart shows the number of people who should be able to understand the language (a.k.a they filled in a 5 or 6) and it also counts the bilinguals multiple times, and 'other' is the people that didn't say they had a profiency of at least 5 of any of the languages.

### Chart C

```{r}

```


